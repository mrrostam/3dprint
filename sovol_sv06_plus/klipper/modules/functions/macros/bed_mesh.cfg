[gcode_macro RUN_BED_MESH_CALIBRATION]
description: Heats bed and extruder, then runs a full bed mesh calibration and saves it.
gcode:
    {% set BED_TEMP = params.BED_TEMP|default(65)|int %}
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|int %}

    M118 Heating bed to {BED_TEMP}C and extruder to {EXTRUDER_TEMP}C...
    SET_HEATER_TEMPERATURE HEATER=heater_bed TARGET={BED_TEMP}
    SET_HEATER_TEMPERATURE HEATER=extruder TARGET={EXTRUDER_TEMP}
    
    M118 Waiting for temperatures to stabilize...
    TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={BED_TEMP}
    TEMPERATURE_WAIT SENSOR=extruder MINIMUM={EXTRUDER_TEMP}

    M118 Homing...
    G28

    M118 Running bed mesh calibration...
    BED_MESH_CALIBRATE

    M118 Moving to safe position...
    G0 X1 Y115 Z50 F10000

    M118 Saving mesh profile 'SV06_mesh' and configuration...
    BED_MESH_PROFILE SAVE=SV06_mesh
    SAVE_CONFIG
    M118 Bed mesh calibration complete.